{
  "hash": "4b559ff6b99e691b5c79a817650fbf62",
  "result": {
    "engine": "knitr",
    "markdown": "---\ntitle: Beta-density selection models for meta-analysis\ndate: '2024-10-23'\ndraft: true\ncategories:\n- effect size\n- distribution theory\n- selective reporting\nexecute:\n  echo: false\ncode-fold: true\nbibliography: \"../selection-references.bib\"\ncsl: \"../apa.csl\"\nlink-citations: true\ncode-tools: true\ntoc: true\ncss: styles.css\ncrossref: \n  eq-prefix: \"\"\n---\n\n\nI still have meta-analytic selection models on my mind. \nAs part of [an IES-funded project](https://ies.ed.gov/funding/grantsearch/details.asp?ID=5730) with [colleagues from the American Institutes for Research](https://www.air.org/mosaic/experts), I've been working on developing methods for estimating selection models that can accommodate dependent effect sizes.\nWe're looking at two variations of p-value selection models: step-function selection models  similar to those proposed by @hedges1992modeling and @vevea1995general and beta-density models as developed in @Citkowicz2017parsimonious. \nBoth models fall within the broader class of $p$-value selection models, which make explicit assumptions about the probability of observing an effect size, given its statistical significance level and sign. \nI've already described how step-function models work (see [this previous post](/posts/step-function-selection-models/)) and, as a bit of a detour, I also took a stab at demystifying the [Copas selection model](/posts/Copas-selection-models). \nIn this post, I'll look at the beta-density model,  highlight how it differs from step-function models, and explain some of the tweaks to the model that we're examining as part of the project. \n\n# The beta-density selection model \n\nThe beta-density selection model is another entry in the class of $p$-value selection models. \nLike the step-function model, it consists of a set of assumptions about\nhow effect size estimates are generated prior to selection (the _evidence-generation process_), and a set of assumptions about how selective reporting happens as a function of the effect size estimates (the _selective reporting process_).\nIn both the beta-density and step-function models, the evidence-generating process is a random effects model:\n$$\nT_i^* | \\sigma_i^* \\sim N\\left(\\mu, \\tau^2 + \\left(\\sigma_i^*\\right)^2\\right),\n$$ {#eq-evidence-generation}\nwhere $T_i^*$ denotes an effect size estimate prior to selective reporting and $\\sigma_i^*$ denotes its (known) standard error.[^metareg]\n\n[^metareg]: With either model, the evidence-generating process can be extended to include a meta-regression with predictors of the average effect size. This amounts to replacing $\\mu$ with $\\beta_0 + \\beta_1 x_{1i} + \\cdots + \\beta_p x_{pi}$ for some set of predictors $x_{1i},...,x_{pi}$. For simplicity, I'm not going to worry about this additional complexity as part of this post.\n\nThe only difference between the beta-density and step-function selection models is the functional form of the selective reporting process. \nLetting $O_i^*$ be an indicator equal to 1 if $T_i^*$ is reported and $p_i^* = 1 - \\Phi\\left(T_i^* / \\sigma_i^*\\right)$ be the one-sided p-value corresponding to the effect size estimate, \nthe selective reporting process describes the shape of $\\text{Pr}(O_i^* = 1 | p_i^*)$.\nThe step-function model uses a piece-wise constant function with level shifts at analyst-specified significance thresholds (see @fig-step-fun). \nThe beta-density model instead uses...wait for it...a beta density kernel function, which can take on a variety of smooth shapes over the unit interval (see @fig-beta-dens).\n\n::: {.column-body-outset layout-ncol=2}\n\n\n::: {.cell}\n::: {.cell-output-display}\n![Two-step selection model with $\\lambda_1 = 0.6, \\lambda_2 = 0.4$](index_files/figure-html/fig-step-fun-1.png){#fig-step-fun width=480}\n:::\n:::\n\n::: {.cell}\n::: {.cell-output-display}\n![Beta-density selection model with $\\lambda_1 = 0.5, \\lambda_2 = 0.8$](index_files/figure-html/fig-beta-dens-1.png){#fig-beta-dens width=480}\n:::\n:::\n\n\n:::\n\nIn the original formulation of the beta density model, the selection function is given by\n$$\n\\text{Pr}(O_i^* = 1 | p_i^*) \\propto \\left(p_i^*\\right)^{(\\lambda_1 - 1)} \\left(1 - p_i^*\\right)^{(\\lambda_2 - 1)},\n$$\nwhere the parameters $\\lambda_1$ and $\\lambda_2$ must be strictly greater than zero, and $\\lambda_1 = \\lambda_2 = 1$ corresponds to a constant probability of selection (i.e., no selective reporting bias).\nIn proposing the model, @Citkowicz2017parsimonious argued that the beta-density function provides a parsimonious expression of more complex forms of selective reporting than can easily be captured by a step function. \nFor instance, the beta density in @fig-beta-dens is smoothly declining from $p < .005$ through the psychologically salient thresholds $p = .025$ and $p = .05$ and beyond. In order to approximate such a smooth curve with a step function, one would have to use many thresholds and therefore many more than the two parameters of the beta density.\n\n# A truncated beta-density\n\nAlthough using smoothly varying selection probabilities may seem appealing, the beta density also comes with an important limitation, highlighted in a commentary by @hedges2017plausibility. For some parameter values, the beta density implies selection probabilities that differ by many orders of magnitude. These extreme differences in selection probability can imply implausible selection processes, in which hundreds of non-significant effect size estimates would need to go unreported to observe a sample of a few dozen findings. Extreme differences in selection probabilities make the model highly sensitive to the inclusion or exclusion of some effect size estimates because the influence of each estimate is driven by the inverse of its selection probability [@hedges2017plausibility]. \n\nIn part to address these issues with the beta density, we consider a modification of the model where the function is truncated at $p$-values larger or smaller than certain thresholds. \nFor user-specified thresholds $\\alpha_1$ and $\\alpha_2$, let $\\tilde{p}_i^* = \\min\\{\\max\\{\\alpha_1, p_i^*\\}, \\alpha_2\\}$. The truncated beta density is then \n$$\n\\text{Pr}(O_i^* = 1 | p_i^*) \\propto (\\tilde{p}_i^*)^{(\\lambda_1 - 1)} \\left(1 - \\tilde{p}_i^*\\right)^{(\\lambda_2 - 1)},\n$$ {#eq-selection-process}\nSetting the truncation thresholds at psychologically salient levels such as $\\alpha_1 = .025$ and $\\alpha_2 = .975$ (which correspond to positive and negative effects that are statistically significant based on two-sided tests with $\\alpha = .05$) gives something kind of like the step-function selection model, but with smoothly varying selection probabilities in the interior. \nAlternately, one could set the second threshold at $\\alpha_2 = .500$ (corresponding to an effect of zero) so that all negative effect size estimates have a constant probability of selection, but positive effect size estimates that are non-significant have smoothly varying selection probabilities, up to the point where $p_i^* = .025$.\n\n# Distribution of observed effect sizes\n\nJust as with the step-function selection model, the assumptions of the evidence-generating process (@eq-evidence-generation) and the selection process (@eq-selection-process) can be combined to obtain the distribution of observed effect sizes, \nwith \n$$\n\\begin{aligned}\n\\Pr(T_i = t | \\sigma_i) &\\propto \\Pr\\left(O_i^* = 1| p_i^*\\right) \\times \\Pr(T_i^*  = t| \\sigma_i^* = \\sigma_i) \\\\\n&\\propto \\frac{(\\tilde{p}_i^*)^{(\\lambda_1 - 1)} \\left(1 - \\tilde{p}_i^*\\right)^{(\\lambda_2 - 1)}}{\\sqrt{\\tau^2 + \\sigma_i^2}}\\times \\phi\\left(\\frac{t - \\mu}{\\sqrt{\\tau^2 + \\sigma_i^2}}\\right)\n\\end{aligned}\n$$\n\nHere is an interactive graph showing the distribution of the effects prior to selection (in grey) and the distribution of observed effect sizes (in blue) based on the truncated beta-density selection model. Initially, the truncation points are set at $\\alpha_1 = .025$ and $\\alpha_2 = .975$ and the selection parameters are set to $\\lambda_1 = 0.5$ and $\\lambda_2 = 0.8$, but you can change these however you like.\nBelow the effect size distribution are the moments of the distribution (computed numerically) and a graph of the truncated beta density that determines the selection probabilities.\n\n\n```{ojs}\nmath = require(\"mathjs\")\nnorm = import('https://unpkg.com/norm-dist@3.1.0/index.js?module')\n\nfunction findprob(p, alp1, alp2, lam1, lam2) {\n  let p_ = math.min(math.max(p, alp1), alp2);\n  let prob = (p_)**(lam1 - 1) * (1 - p_)**(lam2 - 1);\n  return prob;\n}\n\neta = math.sqrt(tau**2 + sigma**2)\n\nmax_p = {\n  if (lambda1 + lambda2 > 2) {\n    return (lambda1 - 1) / (lambda1 + lambda2 - 2);\n  } else if (lambda1 > lambda2) {\n    return alpha2;\n  } else {\n    return alpha1;\n  }\n}\n\nmax_prob = findprob(max_p, alpha1, alpha2, lambda1, lambda2)\n\n```\n\n```{ojs}\npts = 201\n\ndat = Array(pts).fill().map((element, index) => {\n  let t = mu - 3 * eta + index * eta * 6 / (pts - 1);\n  let p = 1 - norm.cdf(t / sigma);\n  let dt = norm.pdf((t - mu) / eta) / eta;\n  let prob = findprob(p, alpha1, alpha2, lambda1, lambda2);\n  return ({\n    t: t,\n    d_unselected: dt,\n    d_selected: prob * dt / max_prob\n  })\n})\n\nselfundat = Array(pts).fill().map((element, index) => {\n  let p = index / (pts - 1);\n  let prob = findprob(p, alpha1, alpha2, lambda1, lambda2);\n  return ({\n    p: p,\n    prob: prob\n  })\n})\n\nmoments = {\n  let prob = 0;\n  let ET = 0;\n  let ET2 = 0;\n  for (let i = 0; i < pts; i++) {\n    prob += dat[i].d_selected;\n  \tET += dat[i].t * dat[i].d_selected;\n    ET2 += dat[i].t**2 * dat[i].d_selected;\n  }\n  let ET_val = ET / prob;\n  let VT_val = ET2 / prob - ET_val**2;\n  return ({\n    Ai: prob * 6 * eta / (pts - 1),\n    ET: ET_val,\n    SDT: math.sqrt(VT_val)\n  })\n}\n\neta_toprint = eta.toFixed(3)\nAi_toprint = moments.Ai.toFixed(3)\nET_toprint = moments.ET.toFixed(3)\nSDT_toprint = moments.SDT.toFixed(3)\n\n```\n\n\n:::::: {.grid .column-page}\n\n::::: {.g-col-8 .center}\n\n\n```{ojs}\nPlot.plot({\n  height: 300,\n  width: 700,\n  y: {\n    grid: false,\n    label: \"Density\"\n  },\n  x: {\n    label: \"Effect size estimate (Ti)\"\n  },   \n  marks: [\n    Plot.ruleY([0]),\n    Plot.ruleX([0]),\n    Plot.areaY(dat, {x: \"t\", y: \"d_unselected\", fillOpacity: 0.3}),\n    Plot.areaY(dat, {x: \"t\", y: \"d_selected\", fill: \"blue\", fillOpacity: 0.5}),\n    Plot.lineY(dat, {x: \"t\", y: \"d_selected\", stroke: \"blue\"})\n  ]\n})\n```\n\n\n:::: {.grid}\n\n:::{.g-col-4 .moments}\n \n\n```{ojs}\ntex`\n\\begin{aligned}\n\\Pr(O_i^* = 1) &= ${Ai_toprint} \\\\\n\\mu &= ${mu} \\\\\n\\mathbb{E}\\left(T_i\\right) &= ${ET_toprint} \\\\ \n\\eta_i &= ${eta_toprint} \\\\\n\\sqrt{\\mathbb{V}\\left(T_i\\right)} &= ${SDT_toprint}\n\\end{aligned}`\n```\n\n\n:::\n\n::: {.g-col-8 .center}\n\n\n```{ojs}\nPlot.plot({\n  height: 200,\n  width: 400,\n  y: {\n    grid: false,\n    label: \"Selection probability\"\n  },\n  x: {\n    label: \"p-value (one-sided)\"\n  },   \n  marks: [\n    Plot.ruleY([0]),\n    Plot.ruleX([0,1]),\n    Plot.areaY(selfundat, {x: \"p\", y: \"prob\", fill: \"green\", fillOpacity: 0.5}),\n    Plot.lineY(selfundat, {x: \"p\", y: \"prob\", stroke: \"green\"})\n  ]\n})\n```\n\n\n:::\n\n::::\n\n:::::\n\n::::: {.g-col-4}\n\n\n```{ojs}\n//| panel: input\n\nviewof mu = Inputs.range(\n  [-2, 2], \n  {value: 0.15, step: 0.01, label: tex`\\mu`}\n)\n\nviewof tau = Inputs.range(\n  [0, 2], \n  {value: 0.10, step: 0.01, label: tex`\\tau`}\n)\n\nviewof sigma = Inputs.range(\n  [0, 1], \n  {value: 0.20, step: 0.01, label: tex`\\sigma_i`}\n)\n\nviewof alpha1 = Inputs.range(\n  [0, 1],\n  {value: 0.025, step: 0.005, label: tex`\\alpha_1`}\n)\n\nviewof alpha2 = Inputs.range(\n  [0, 1],\n  {value: 0.975, step: 0.005, label: tex`\\alpha_2`}\n)\n\nviewof lambda1 = Inputs.range(\n  [0, 5],\n  {value: 0.50, step: 0.01, label: tex`\\lambda_1`}\n)\n\nviewof lambda2 = Inputs.range(\n  [0, 5],\n  {value: 0.80, step: 0.01, label: tex`\\lambda_2`}\n)\n\n```\n\n\n:::::\n\n::::::\n\n# Empirical example\n\n@Citkowicz2017parsimonious presented an example of a meta-analysis where applying the original form of the beta-density selection model led to dramatically different findings from the summary meta-analysis. The data come from a synthesis by @baskerville2012systematic that examined the effects of practice facilitation on the uptake of evidence-based practices (EBPs) in primary care settings. The original meta-analysis found a large average effect indicating that facilitation improves adoption of EBPs, although there were also indications of publication bias based on an Egger's regression test. Fitting the beta-density model leads to much smaller effects.\nHowever, @hedges2017plausibility criticized the beta-density results as involving an implausibly large degree of selection and noted that the estimated average effect is very sensitive to high-influence observations.\nDoes using a more strongly truncated beta density change this picture? I'll first work through the previously presented analyses, then examine the extent to which introducing truncation points for the beta density affects the model estimates.\n\n## Summary random effects model\n\nHere are the random effects meta-analysis results, estimated using maximum likelihood for consistency with subsequent modeling:\n\n\n::: {.cell}\n\n```{.r .cell-code}\nlibrary(tibble)\nlibrary(dplyr)\nlibrary(tidyr)\nlibrary(metafor)\n\nBaskerville <- tribble(\n  ~ SMD, ~ V, ~ Blinded,\n  1.01,\t0.2704,\t'B',\n  0.82,\t0.2116,\t'O',\n  0.59,\t0.0529,\t'O',\n  0.44,\t0.0324,\t'O',\n  0.84,\t0.0841,\t'B',\n  0.73,\t0.0841,\t'O',\n  1.12,\t0.1296,\t'B',\n  0.04,\t0.1369,\t'B',\n  0.24,\t0.0225,\t'O',\n  0.32,\t0.1600,\t'O',\n  1.04,\t0.1024,\t'O',\n  1.31,\t0.3249,\t'B',\n  0.59,\t0.0841,\t'B',\n  0.66,\t0.0361,\t'O',\n  0.62,\t0.0961,\t'B',\n  0.47,\t0.0729,\t'B',\n  1.08,\t0.1024,\t'O',\n  0.98,\t0.1024,\t'B',\n  0.26,\t0.0324,\t'B',\n  0.39,\t0.0324,\t'B',\n  0.60,\t0.0961,\t'B',\n  0.94,\t0.2809,\t'B',\n  0.11,\t0.0729,\t'B'\n)\n\nRE_fit <- rma(yi = SMD, vi = V, data = Baskerville, method = \"ML\")\nRE_fit\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n\nRandom-Effects Model (k = 23; tau^2 estimator: ML)\n\ntau^2 (estimated amount of total heterogeneity): 0.0162 (SE = 0.0236)\ntau (square root of estimated tau^2 value):      0.1274\nI^2 (total heterogeneity / total variability):   18.64%\nH^2 (total variability / sampling variability):  1.23\n\nTest for Heterogeneity:\nQ(df = 22) = 27.5518, p-val = 0.1910\n\nModel Results:\n\nestimate      se    zval    pval   ci.lb   ci.ub      \n  0.5552  0.0633  8.7751  <.0001  0.4312  0.6792  *** \n\n---\nSignif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1\n```\n\n\n:::\n:::\n\n\nThe average effect estimate is $\\hat\\mu = 0.555$, with a 95% CI of $[0.431, 0.679]$. Here is a funnel plot of the effect size estimates against standard errors, with contours indicating regions of statistical significance for positive and negative estimates:\n\n::: {.cell}\n\n```{.r .cell-code}\npar(mar=c(4,4,0,2))\nfunnel(RE_fit, refline = 0)\n```\n\n::: {.cell-output-display}\n![Funnel plot of effect size estimates from the Baskerville meta-analysis](index_files/figure-html/fig-funnel-1.png){#fig-funnel width=80%}\n:::\n:::\n\nThere's clearly asymmetry in the funnel plot, which can be an indication of selective reporting.\n\n## Original beta-density model\n\n@Citkowicz2017parsimonious fit the original form of the beta-density model to the data. This is now quite easy to do with the `metafor` package:\n\n::: {.cell}\n\n```{.r .cell-code}\nbeta_fit <- selmodel(RE_fit, type = \"beta\")\nbeta_fit\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n\nRandom-Effects Model (k = 23; tau^2 estimator: ML)\n\ntau^2 (estimated amount of total heterogeneity): 0.0000\ntau (square root of estimated tau^2 value):      0.0016\n\nTest for Heterogeneity:\nLRT(df = 1) = 0.0088, p-val = 0.9252\n\nModel Results:\n\nestimate      se    zval    pval    ci.lb   ci.ub    \n  0.1147  0.1664  0.6895  0.4905  -0.2114  0.4409    \n\nTest for Selection Model Parameters:\nLRT(df = 2) = 7.8469, p-val = 0.0198\n\nSelection Model Results:\n\n         estimate      se     zval    pval   ci.lb   ci.ub    \ndelta.1    0.4731  0.2352  -2.2397  0.0251  0.0120  0.9342  * \ndelta.2    4.4613  2.1842   1.5847  0.1130  0.1803  8.7423    \n\n---\nSignif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1\n```\n\n\n:::\n:::\n\nThe overall average effect size in the un-selected population is now estimated to be $\\hat\\mu = 0.115$, 95% CI $[-0.211, 0.441]$, with selection parameters (called $\\delta_1$ and $\\delta_2$ in metafor) estimated as $\\hat\\lambda_1 = 0.473$ and $\\hat\\lambda_2 = 4.461$. \n\nThe same model can also be fit using our `metaselection` package:\n\n::: {.cell}\n\n```{.r .cell-code}\nlibrary(metaselection)\nBaskerville$se <- sqrt(Baskerville$V)\nBaskerville$p <- with(Baskerville, pnorm(SMD / se, lower.tail = FALSE))\n\nbeta_sel <- selection_model(\n  data = Baskerville,\n  yi = SMD,\n  sei = se,\n  selection_type = \"beta\",\n  steps = c(1e-5, 1 - 1e-5),\n  vcov_type = \"model-based\"\n)\n\nsummary(beta_sel)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\nBeta Density Model \n \nCall: \nselection_model(data = Baskerville, yi = SMD, sei = se, selection_type = \"beta\", \n    steps = c(1e-05, 1 - 1e-05), vcov_type = \"model-based\")\n\nNumber of effects = 23\n\nSteps: 1e-05, 0.99999 \nEstimator: maximum likelihood \nVariance estimator: model-based \n\nLog composite likelihood of selection model: -2.79229\n\nMean effect estimates:                                        \n                            Large Sample\n Coef. Estimate Std. Error  Lower  Upper\n  beta    0.115      0.166 -0.211   0.44\n\nHeterogeneity estimates:                                            \n                              Large   Sample\n Coef. Estimate Std. Error    Lower    Upper\n  tau2 3.79e-11   1.38e-20 3.79e-11 3.79e-11\n\nSelection process estimates:                                          \n                              Large Sample\n    Coef. Estimate Std. Error Lower  Upper\n lambda_1    0.473      0.235 0.179   1.25\n lambda_2    4.461      2.184 1.709  11.65\n```\n\n\n:::\n:::\n\nI will stick with the `metaselection` package for subsequent analysis because it allows the user to specify their own truncation points for the beta-density model. It also has some helper functions such as `selection_plot()` for graphing the estimated selection function:\n\n::: {.cell}\n\n```{.r .cell-code}\nselection_plot(beta_sel)\n```\n\n::: {.cell-output-display}\n![](index_files/figure-html/unnamed-chunk-13-1.png){width=70%}\n:::\n:::\n\n\n## Hedges' critiques\n\n::: {.column-margin}\n\n::: {#tbl-selection-probs .cell tbl-cap='Probabilities of selection relative to $\\text{Pr}(O_i = 1 \\vert p_i = .0005)$'}\n::: {.cell-output-display}\n\n\n| $p_i$| $\\text{Pr}(O_i = 1 \\vert p_i)$|\n|-----:|------------------------------:|\n| 0.001|                          0.693|\n| 0.005|                          0.293|\n| 0.010|                          0.200|\n| 0.025|                          0.117|\n| 0.050|                          0.074|\n| 0.100|                          0.043|\n| 0.500|                          0.002|\n\n\n:::\n:::\n\n:::\n\n@hedges2017plausibility noted that the beta-density model for these data generates very extreme selection probabilities. Following along with his numerical example, @tbl-selection-probs reports the probability of observing effects for several different $p$-values, relative to the probability of observing a highly significant effect with $p = .0005$.\nNotably, based on the estimated selection function, an effect with one-sided $p_i = .0005$ is over eight times more likely to be reported than an effect with $p = .025$ and nearly 500 times more likely to be reported than an effect of zero with $p_i = .500$. Quoth @hedges2017plausibility: \"This seems like an extraordinarily high degree of selection\" (p. 43).\n\nHedges goes on to explain how the estimated selection parameters can be used to infer the total number of effect sizes that would need to be _generated_ in order to obtain a sample of $k = 23$ observed effect sizes. The calculation involves the quantity \n$$\nA_i = \\text{Pr}(O_i^* = 1 | \\sigma_i^*) = \\text{E}\\left[\\left.\\Pr\\left(O_i^* = 1| p_i^*\\right) \\right| \\sigma_i^*\\right],\n$$\nwhich is the overall probability of observing an effect size estimate in a study with standard error $\\sigma_i^*$.^[@hedges2017plausibility denotes this quantity as $g_i(T_i)$.]\nThe inverse of $A_i$ is the expected number of effect size estimates that would need to be generated (including both those that are subsequently reported and those that remain unreported) in order to obtain one observed estimate. \nA challenge here is that the selection is only identified up to a proportionality constant, so the _absolute_ probability of reporting cannot be estimated without making some further assumption.\nHedges approaches this by assuming that any effect size estimate with $p$-value equal to the smallest observed $p$-value will be reported with certainty, so that the proportionality constant becomes $w_{min} = (p_{min})^{\\lambda_1 - 1} (1 - p_{min})^{\\lambda_2 - 1}$.\nUnder this assumption, estimates of $A_i$ can be computed given the parameter estimates $\\hat\\mu$, $\\hat\\tau$, $\\hat\\lambda_1$, $\\hat\\lambda_2$ and the reference $p$-value $p_{min}$. \nTaking the sum across the sample of observed standard errors, we can find an estimate of the number of effect sizes that would need to be generated:\n$$\nk_{gen} = \\sum_{i=1}^{k} \\frac{1}{\\hat{A}_i}.\n$$\n\n\n::: {.cell}\n\n:::\n\n\nMy attempt to reproduce the calculations in Table 1 of @hedges2017plausibility are displayed in @tbl-Hedges-Table1 below \nColumns $T_i$ and $\\sigma_i$ are the effect size estimates and standard errors reported by @baskerville2012systematic; $p_i$ is the one-sided $p$-value calculated from the data. The column labeled $\\hat{w}(p_i)$ is the relative selection probability calculated from the estimated selection parameters $\\hat\\lambda_1 = 0.473, \\hat\\lambda_2 = 4.461$; the next column reports the same quantities, standardized by the relative probability of observation 14, which has the smallest reported $p$-value of $p_{min} = 2.6\\times 10^{-4}$. \nUsing the beta-density parameter estimates and standardizing to the minimum observed $p$-value, I calculate the probability of observing effect size estimates with each observed standard error. \nThe inverse of this quantity is the number of generated effect sizes one would need to produce a single observed effect size estimate; it is reported in the column labeled $\\hat{A}_i^{-1}$.\nTotalling these, I find $k_{gen} = 972$.[^Hedges-discrepancy]\nThis implies quite a large number of missing studies that were conducted but not reported; Hedges argues that it is so large as to be implausible.\n\n[^Hedges-discrepancy]: My estimate of $k_{gen}$ and the component quantities differ from those reported in Table 1 of @hedges2017plausibility; I am currently unsure why there is a discrepancy.\n\n\n::: {#tbl-Hedges-Table1 .cell tbl-cap='Effect size estimates and computed values for beta density selection model estimated on Baskerville meta-analysis data'}\n::: {.cell-output-display}\n\n\n| Study| $T_i$| $\\sigma_i$| $p_i$| $\\hat{w}(p_i)$| $\\hat{w}(p_i) / \\hat{w}(p_{min})$| $\\hat{A}_i^{-1}$| $\\omega_i$|\n|-----:|-----:|----------:|-----:|--------------:|---------------------------------:|----------------:|----------:|\n|     1|  1.01|       0.52| 0.026|          6.237|                             0.080|           56.484|      0.014|\n|     2|  0.82|       0.46| 0.037|          4.957|                             0.064|           53.788|      0.018|\n|     3|  0.59|       0.23| 0.005|         15.760|                             0.202|           35.335|      0.006|\n|     4|  0.44|       0.18| 0.007|         13.069|                             0.168|           28.034|      0.007|\n|     5|  0.84|       0.29| 0.002|         27.073|                             0.348|           42.016|      0.003|\n|     6|  0.73|       0.29| 0.006|         14.622|                             0.188|           42.016|      0.006|\n|     7|  1.12|       0.36| 0.001|         39.385|                             0.506|           47.834|      0.002|\n|     8|  0.04|       0.37| 0.457|          0.183|                             0.002|           48.536|      0.485|\n|     9|  0.24|       0.15| 0.055|          3.800|                             0.049|           22.676|      0.023|\n|    10|  0.32|       0.40| 0.212|          0.994|                             0.013|           50.483|      0.089|\n|    11|  1.04|       0.32| 0.001|         50.764|                             0.652|           44.724|      0.002|\n|    12|  1.31|       0.57| 0.011|         10.481|                             0.135|           58.376|      0.008|\n|    13|  0.59|       0.29| 0.021|          7.123|                             0.091|           42.016|      0.012|\n|    14|  0.66|       0.19| 0.000|         77.873|                             1.000|           29.647|      0.001|\n|    15|  0.62|       0.31| 0.023|          6.777|                             0.087|           43.861|      0.013|\n|    16|  0.47|       0.27| 0.041|          4.666|                             0.060|           39.997|      0.019|\n|    17|  1.08|       0.32| 0.000|         64.286|                             0.826|           44.724|      0.001|\n|    18|  0.98|       0.32| 0.001|         36.113|                             0.464|           44.724|      0.002|\n|    19|  0.26|       0.18| 0.074|          3.011|                             0.039|           28.034|      0.029|\n|    20|  0.39|       0.18| 0.015|          8.631|                             0.111|           28.034|      0.010|\n|    21|  0.60|       0.31| 0.026|          6.176|                             0.079|           43.861|      0.014|\n|    22|  0.94|       0.53| 0.038|          4.893|                             0.063|           56.885|      0.018|\n|    23|  0.11|       0.27| 0.342|          0.414|                             0.005|           39.997|      0.214|\n\n\n:::\n:::\n\n\nAnother, related limitation of the beta density model is that it puts extreme emphasis on a few individual observations that have low probability of selection. \n@hedges2017plausibility suggests that the influence of individual observations can be approximated by the inverse selection probabilities, such that the fraction of the total weight allocated to observation $i$ is\n$$\n\\omega_i = \\frac{1 / \\hat{w}(p_i)}{\\sum_{j=1}^k 1 / \\hat{w}(p_j)}.\n$$\nThe last column of @tbl-Hedges-Table1 reports these relative weights. \nAs Hedges noted, the overall average effect is strongly influenced by just two observations: study 8, which has approximately 49% of the weight, and study 23, which has approximately 21% of the weight. \n\n## Sensitivity to truncation points\n\nDoes introducing truncation points into the beta density selection function change this picture in any meaningful way? My intuition is that using truncation points connected to psychologically salient thresholds (such as $\\alpha_1 = .025$ and $\\alpha_2 = .50$ or $.975$) should tend to moderate things in terms of both the implied overall degree of selection and the degree to which individual observations influence the model results. Here's what happens if I use truncation points corresponding to the usual 2-sided significance threshold of $\\alpha = .05$:\n\n\n::: {.cell}\n::: {.cell-output .cell-output-stdout}\n\n```\nBeta Density Model \n \nCall: \nselection_model(data = Baskerville, yi = SMD, sei = se, selection_type = \"beta\", \n    steps = c(0.025, 0.975), vcov_type = \"model-based\")\n\nNumber of effects = 23\n\nSteps: 0.025, 0.975 \nEstimator: maximum likelihood \nVariance estimator: model-based \n\nLog composite likelihood of selection model: -1.94561\n\nMean effect estimates:                                        \n                            Large Sample\n Coef. Estimate Std. Error  Lower  Upper\n  beta    0.188      0.437 -0.669   1.05\n\nHeterogeneity estimates:                                          \n                              Large Sample\n Coef. Estimate Std. Error    Lower  Upper\n  tau2   0.0574      0.122 0.000874   3.77\n\nSelection process estimates:                                               \n                                 Large   Sample\n    Coef. Estimate Std. Error    Lower    Upper\n lambda_1 3.41e-09   2.81e-17 3.41e-09 3.41e-09\n lambda_2 1.74e+00   2.10e+00 1.63e-01 1.86e+01\n```\n\n\n:::\n:::\n\n\nUnder the truncated beta density, the estimated average effect size increases a bit to $\\hat\\mu = 0.188$, but with much greater uncertainty, 95% CI $[-0.669, 1.046]$. \nContributing to this additional uncertainty is the larger estimate of between-study heterogeneity, $\\tau^2 =  0.057$. \nThe selection parameters are now estimated as $\\hat\\lambda_1 \\approx 0$ and $\\hat\\lambda_2 = 1.741$. \n\n\n::: {.cell}\n::: {.cell-output-display}\n![Estimated selection function under the truncated beta density model (green) and original beta density model (blue).](index_files/figure-html/fig-selection-functions-1.png){#fig-selection-functions width=80%}\n:::\n:::\n\n\n@fig-selection-functions is a graph of the estimated selection function. The green area is the selection function based on the truncated beta density model; for reference, the blue area is the selection function from the previous, untruncated model. \nThe model with truncation points does clearly imply a more moderate degree of selective reporting, although it still represents a fairly strong degree of selection.\nThe estimated selection parameters imply that $k_{gen} = 89$ effect sizes would need to have been generated to produce a sample of 23 observed effects---this is large but not nearly so far outside the realm of plausible as with the untruncated beta density. \n\nTo get a more systematic sense of how sensitive the results are to the use of truncation points, I re-estimated the model many times with a range of different truncation points. For the left-hand truncation, I looked at $\\alpha_1$ ranging from $10^{-5}$ to $10^{-2}$ and then also $\\alpha_1 = .025$ and $\\alpha_1 = .05$; for every one of these values, I looked at two different right-hand truncation points, first setting $\\alpha_2 = 1 - \\alpha_1$ and then fixing $\\alpha_2 = .5$. With each model, I tracked the maximum log-likelihood, estimated mean and variance of the effects prior to selective reporting, and the total number of generated effects ($k_{gen}$) implied by the fitted model. The results are depicted in @fig-parameter-sensitivity.\n\n\n::: {.cell}\n\n:::\n\n::: {.cell layout-align=\"center\"}\n::: {.cell-output-display}\n![Sensitivity analysis for the beta density model across varying truncation points](index_files/figure-html/fig-parameter-sensitivity-1.png){#fig-parameter-sensitivity fig-align='center' width=100%}\n:::\n:::\n\n\nIn the top left-hand panel of @fig-parameter-sensitivity, it can be seen that the estimate of $k_{gen}$ is _strongly_ influenced by the truncation point. \nModels with $\\alpha_1 = 2 \\times 10^{-4}$ and neighboring truncation points produce extremely high estimates, with $k_{gen} > 2500$. \nModels with more psychologically relevant truncation points of $\\alpha_1 = .01$ or $.025$ lead to much more moderated estimates with $k_{gen} < 150$. \nThe top right-hand panel shows the log-likelihood of models with different truncation points. \nModels where $\\alpha_2 = 1 - \\alpha_1$ consistently have higher likelihood than those with the right-hand truncation point fixed to $\\alpha_2 = .5$. \nOf those examined, the truncation point with the highest overall likelihood is $\\alpha_1 = 5 \\times 10^{-4}$, which is rather curious. \nThe bottom panels of @fig-parameter-sensitivity depict the parameter estimates $\\hat\\mu$ and $\\hat\\tau^2$; $\\hat\\mu$ is fairly sensitive to the choice of truncation point, though $\\hat\\tau^2$ is sensitive only for larger truncation points of $\\alpha_1 \\geq .01$. \n\n\n::: {.cell layout-align=\"center\"}\n::: {.cell-output-display}\n![Sensitivity of approximate weights $\\omega_i$ under the beta density model across varying truncation points](index_files/figure-html/fig-weight-sensitivity-1.png){#fig-weight-sensitivity fig-align='center' width=100%}\n:::\n:::\n\n\n@fig-weight-sensitivity plots the fraction of the total weight (i.e., the $\\omega_i$ values for each effect size) assigned to each effect size as a function of the left-hand truncation point; the left panel shows the weights when $\\alpha_2 = 1 - \\alpha_1$ and the right panel shows the same quantities from the slightly lower-likelihood models with $\\alpha_2 = 0.5$.\nAcross both panels, the highest-influence observation (Study $i = 8$) becomes less so when $\\alpha_1$ is set to higher truncation points.\nWhen $\\alpha_1 = .025$, it receives 35% of the total weight, compared to almost 50% in the untruncated model.\nStill, it remains strongly influential.\nThe next-most influential observation (Study $i = 23$) has a fairly stable weight across all truncation points, and the third-most influential observation (Study $i = 10$) grows moreso for higher truncation points. \nEven in the model with the largest truncation point $\\alpha_1 = .025, \\alpha_2 = .975$, these three points still account for \n69% of the total weight.\n\nLooking across all of the model outputs, it seems that adding truncation points to the beta density is consequential, in that the model results are generally sensitive to the specific truncation points chosen.\nIn this example, using psychologically salient truncation points led to less extreme estimates of selection, with less implausible implications, but also yieleded estimates that are still strongly influenced by a few data points.\n\n# Comments\n\n",
    "supporting": [],
    "filters": [
      "rmarkdown/pagebreak.lua"
    ],
    "includes": {},
    "engineDependencies": {},
    "preserve": {},
    "postProcess": true
  }
}
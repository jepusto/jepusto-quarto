{
  "hash": "8eb2f03403aa1b60e5180c5b13c46e95",
  "result": {
    "engine": "knitr",
    "markdown": "---\ntitle: Pusto's package downloads\nsubtitle: June 2024 edition\ndate: '2024-06-23'\ndraft: true\ncategories:\n- programming\n- Rstats\ncode-fold: true\ncode-tools: true\n---\n\n\nBack in 2019, I [posted an analysis](/posts/package-downloads/) of the R packages that I have developed, looking at how frequently they have been downloaded, comparing them to other topically related packages, and examining time trends in download frequency. I was coming up for tenure review at that point and so wanted to document and provide a little bit of data about the software tools that I'd worked on, even though (at my institution, at least) these weren't really understood as academic contributions like journal articles or books or whatnot. \n\nThese days, I'm (happily) tenured at a different university and still developing some R packages, but my work has become much more collaborative. \nOf the four R packages that I looked at in 2019, two were solo projects (`clubSandwich` and `ARPobservation`) and two were my design, with some contributions from students (`SingleCaseES` and `scdhlm`). \nI've since been involved with four additional R packages (`lmeInfo`, `POMADE`, `simhelpers`, and `wildmeta`)---all developed in collaboration with students---and my packages related to single-case effect sizes have seen major contributions from student collaborators.\nIn short, the packages are no longer _mine_, but rather represent tools to which I've contributed. \nI'm no less proud of the products, though. \n\nSince it has been five years since my previous post on package downloads, I felt like it was time for an updated look.\n\n\n::: {.cell}\n\n```{.r .cell-code}\nlibrary(tidyverse)\nlibrary(lubridate)\nlibrary(cranlogs)\n\nfile_name <- paste0(\"CRAN package downloads \", today() - 4L, \".rds\")\nfrom_date <- as.character(as_date(today() - 4L - duration(2, \"year\")))\n```\n:::\n\n\nI used daily download counts from the RStudio CRAN mirror from 2022-06-20 through 2024-06-24. Note that this is only one of 50+ CRAN mirrors, although I think I've heard that it's the most highly trafficked. \n\n\n::: {.cell}\n\n```{.r .cell-code}\npkg_downloads <-\n  available.packages() %>%\n  as_tibble() %>%\n  select(Package, Version) %>%\n  mutate(grp = 1 + trunc((row_number() - 1) / 100)) %>%\n  nest(data = c(Package, Version)) %>%\n  mutate(downloads = map(.$data, ~ cran_downloads(packages = .$Package, from = from_date))) %>%\n  select(-data) %>%\n  unnest(cols = downloads)\n\nsaveRDS(pkg_downloads, file = file_name)\n```\n:::\n\n\nI limited the sample to packages that had been downloaded at least once between 2023-06-24 18:00:00 and 2023-12-24.\n\n\n::: {.cell}\n\n```{.r .cell-code}\npkg_downloads <- readRDS(file_name)\n\ndownloaded_last_yr <- \n  pkg_downloads %>%\n  filter(date <= today() - duration(12, \"months\")) %>%\n  group_by(package) %>%\n  summarise(\n    count = sum(count)\n  ) %>%\n  filter(count > 0) %>%\n  select(package)\n```\n:::\n\n\nThis yielded 19005 packages. For each of these packages, I then calculated the average monthly download rate over the past twelve months, along with where that rate falls as a percentile of all packages in the sample.\n\n\n::: {.cell}\n\n```{.r .cell-code}\ndownloads_past_twelve <-\n  pkg_downloads %>%\n  filter(date > today() - duration(12, \"months\")) %>%\n  semi_join(downloaded_last_yr, by = \"package\") %>%\n  group_by(package) %>%\n  summarise(\n    count = sum(count) / 12\n  ) %>%\n  mutate(\n    pct_less = 100 * cume_dist(count)\n  )\n```\n:::\n\n\nHere are the average monthly download rates (over the past six months) for each of my packages, along with metafor and robumeta:\n\n\n::: {.cell}\n\n```{.r .cell-code}\nPusto_pkgs <- c(\"ARPobservation\",\"scdhlm\",\"SingleCaseES\",\"lmeInfo\",\"clubSandwich\",\"wildmeta\",\"simhelpers\",\"POMADE\")\ncomp_pkgs <- c(\"sandwich\",\"metafor\",\"robumeta\",\"nlme\",\"merDeriv\",\"glmmTMB\",\"plm\",\"PowerUpR\")\n\ndownloads_past_twelve %>%\n  filter(package %in% c(Pusto_pkgs, comp_pkgs)) %>%\n  arrange(desc(pct_less)) %>%\n  rename(`Average monthly downloads` = count, `Percentage of packages with smaller download rate` = pct_less) %>%\n  knitr::kable(digits = 1)\n```\n\n::: {.cell-output-display}\n\n\n|package        | Average monthly downloads| Percentage of packages with smaller download rate|\n|:--------------|-------------------------:|-------------------------------------------------:|\n|sandwich       |                  185981.3|                                              99.0|\n|nlme           |                  116516.2|                                              98.7|\n|plm            |                   41004.3|                                              97.5|\n|metafor        |                   27663.2|                                              96.8|\n|glmmTMB        |                   18139.8|                                              96.0|\n|clubSandwich   |                    5730.1|                                              92.8|\n|merDeriv       |                    4075.9|                                              91.4|\n|robumeta       |                    2435.1|                                              89.1|\n|lmeInfo        |                    1766.8|                                              87.1|\n|wildmeta       |                    1574.2|                                              86.2|\n|scdhlm         |                    1323.5|                                              84.9|\n|SingleCaseES   |                     876.4|                                              81.4|\n|simhelpers     |                     319.6|                                              56.8|\n|ARPobservation |                     318.0|                                              56.6|\n|PowerUpR       |                     276.9|                                              48.9|\n|POMADE         |                     191.9|                                              22.9|\n\n\n:::\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\ndownloads_last_yr <-\n  pkg_downloads %>%\n  group_by(package) %>%\n  summarize(\n    count2 = sum(count[date <= as_date(\"2023-02-28\")]),\n    count = sum(count) / 12\n  ) %>%\n  filter(count2 > 0) %>%\n  mutate(\n    pct_less = 100 * cume_dist(count)\n  )\n\ndownloads_last_yr %>%\n  select(-count2) %>%\n  filter(package %in% c(Pusto_pkgs, comp_pkgs)) %>%\n  arrange(desc(pct_less)) %>%\n  rename(`Average monthly downloads` = count, `Percentage of packages with smaller download rate` = pct_less) %>%\n  knitr::kable(digits = 1)\n```\n\n::: {.cell-output-display}\n\n\n|package        | Average monthly downloads| Percentage of packages with smaller download rate|\n|:--------------|-------------------------:|-------------------------------------------------:|\n|sandwich       |                  424873.1|                                              99.0|\n|nlme           |                  265412.5|                                              98.6|\n|plm            |                  108325.5|                                              97.8|\n|metafor        |                   50133.8|                                              96.5|\n|glmmTMB        |                   38687.6|                                              95.9|\n|clubSandwich   |                   11429.7|                                              92.5|\n|merDeriv       |                    8672.9|                                              91.3|\n|robumeta       |                    5044.9|                                              88.9|\n|lmeInfo        |                    4032.6|                                              87.5|\n|wildmeta       |                    3276.6|                                              85.9|\n|scdhlm         |                    3083.9|                                              85.5|\n|SingleCaseES   |                    1661.8|                                              80.3|\n|ARPobservation |                     677.6|                                              57.9|\n|PowerUpR       |                     640.8|                                              55.1|\n|simhelpers     |                     554.2|                                              46.5|\n|POMADE         |                     279.4|                                               1.9|\n\n\n:::\n:::\n\n\nHere are the weekly download rates for each of these packages (note that the vertical scales of the graphs differ).\n\n\n::: {.cell}\n\n```{.r .cell-code}\nweekly_downloads <- \n  pkg_downloads %>%\n  mutate(\n    yr = year(date),\n    wk = week(date)\n  ) %>%\n  group_by(package, yr, wk) %>%\n  mutate(\n    date = max(date)\n  ) %>%\n  group_by(package, date) %>%\n  summarise(\n    count = sum(count),\n    days = n(),\n    .groups = \"drop\"\n  )\n\nweekly_downloads %>%\n  filter(\n    days == 7,\n    package %in% c(Pusto_pkgs, comp_pkgs)\n  ) %>%\n  ggplot(aes(date, count)) + \n  geom_line() + \n  expand_limits(y = 0) + \n  facet_wrap(~ package, scales = \"free\", ncol = 2) + \n  theme_minimal()\n```\n\n::: {.cell-output-display}\n![](index_files/figure-html/unnamed-chunk-4-1.png){width=768}\n:::\n:::\n",
    "supporting": [
      "index_files"
    ],
    "filters": [
      "rmarkdown/pagebreak.lua"
    ],
    "includes": {},
    "engineDependencies": {},
    "preserve": {},
    "postProcess": true
  }
}